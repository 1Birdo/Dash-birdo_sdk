{"version":3,"file":"browser.esm.js","sources":["../src/browser.js","../src/node.js","../src/index.js"],"sourcesContent":["export class BrowserMonitor {\r\n  constructor(sdk) {\r\n    this.sdk = sdk;\r\n    this._systemInfo = this._getSystemInfo();\r\n  }\r\n\r\n  _getSystemInfo() {\r\n    return {\r\n      platform: 'browser',\r\n      userAgent: navigator.userAgent,\r\n      screenResolution: `${window.screen.width}x${window.screen.height}`,\r\n      language: navigator.language,\r\n      hardwareConcurrency: navigator.hardwareConcurrency || 0,\r\n      deviceMemory: navigator.deviceMemory || 0\r\n    };\r\n  }\r\n\r\n  getSystemInfo() {\r\n    return this._systemInfo;\r\n  }\r\n\r\n  async collectMetrics() {\r\n    try {\r\n      const memory = performance.memory ? {\r\n        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit,\r\n        totalJSHeapSize: performance.memory.totalJSHeapSize,\r\n        usedJSHeapSize: performance.memory.usedJSHeapSize\r\n      } : null;\r\n\r\n      return {\r\n        timestamp: new Date().toISOString(),\r\n        memory,\r\n        performance: {\r\n          timing: this._getTimingMetrics(),\r\n          navigation: this._getNavigationMetrics()\r\n        },\r\n        connection: this._getConnectionInfo()\r\n      };\r\n    } catch (error) {\r\n      this.sdk.logger.error('Failed to collect browser metrics:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  _getTimingMetrics() {\r\n    const timing = performance.timing;\r\n    if (!timing) return null;\r\n    \r\n    return {\r\n      dns: timing.domainLookupEnd - timing.domainLookupStart,\r\n      tcp: timing.connectEnd - timing.connectStart,\r\n      request: timing.responseStart - timing.requestStart,\r\n      response: timing.responseEnd - timing.responseStart,\r\n      domLoading: timing.domLoading - timing.navigationStart,\r\n      domInteractive: timing.domInteractive - timing.navigationStart,\r\n      domComplete: timing.domComplete - timing.navigationStart,\r\n      loadEvent: timing.loadEventEnd - timing.loadEventStart\r\n    };\r\n  }\r\n\r\n  _getNavigationMetrics() {\r\n    const navigation = performance.getEntriesByType('navigation')[0];\r\n    if (!navigation) return null;\r\n    \r\n    return {\r\n      type: navigation.type,\r\n      redirectCount: navigation.redirectCount,\r\n      size: navigation.transferSize,\r\n      duration: navigation.duration\r\n    };\r\n  }\r\n\r\n  _getConnectionInfo() {\r\n    const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\r\n    if (!connection) return null;\r\n    \r\n    return {\r\n      effectiveType: connection.effectiveType,\r\n      rtt: connection.rtt,\r\n      downlink: connection.downlink,\r\n      saveData: connection.saveData\r\n    };\r\n  }\r\n}","import os from 'os';\r\nimport process from 'process';\r\nimport { promises as fs } from 'fs';\r\nimport util from 'util';\r\nimport v8 from 'v8';\r\n\r\nconst exec = util.promisify(require('child_process').exec);\r\n\r\nexport class NodeMonitor {\r\n  constructor(sdk) {\r\n    this.sdk = sdk;\r\n    this._systemInfo = this._getSystemInfo();\r\n    this._prevNetworkStats = null;\r\n    this._prevDiskStats = null;\r\n  }\r\n\r\n  _getSystemInfo() {\r\n    return {\r\n      platform: os.platform(),\r\n      arch: os.arch(),\r\n      release: os.release(),\r\n      hostname: os.hostname(),\r\n      cpuModel: os.cpus()[0]?.model,\r\n      cpuCores: os.cpus().length,\r\n      totalMemory: os.totalmem(),\r\n      nodeVersion: process.version,\r\n      v8Version: process.versions.v8\r\n    };\r\n  }\r\n\r\n  getSystemInfo() {\r\n    return this._systemInfo;\r\n  }\r\n\r\n  async collectMetrics() {\r\n    try {\r\n      const [cpu, memory, disk, network] = await Promise.all([\r\n        this._getCpuMetrics(),\r\n        this._getMemoryMetrics(),\r\n        this._getDiskMetrics(),\r\n        this._getNetworkMetrics()\r\n      ]);\r\n\r\n      return {\r\n        timestamp: new Date().toISOString(),\r\n        cpu,\r\n        memory,\r\n        disk,\r\n        network,\r\n        process: this._getProcessMetrics(),\r\n        load: this._getLoadMetrics()\r\n      };\r\n    } catch (error) {\r\n      this.sdk.logger.error('Failed to collect Node.js metrics:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async _getCpuMetrics() {\r\n    const load = os.loadavg();\r\n    const cpus = os.cpus();\r\n    \r\n    return {\r\n      usage: process.cpuUsage(),\r\n      load1: load[0],\r\n      load5: load[1],\r\n      load15: load[2],\r\n      speed: cpus[0]?.speed || 0,\r\n      cores: cpus.length\r\n    };\r\n  }\r\n\r\n  async _getMemoryMetrics() {\r\n    return {\r\n      system: {\r\n        total: os.totalmem(),\r\n        free: os.freemem(),\r\n        used: os.totalmem() - os.freemem()\r\n      },\r\n      process: process.memoryUsage(),\r\n      heap: v8.getHeapStatistics()\r\n    };\r\n  }\r\n\r\n  async _getDiskMetrics() {\r\n    try {\r\n      const stats = await fs.statfs('/');\r\n      const currentStats = {\r\n        read: (await exec('cat /proc/diskstats')).stdout,\r\n        timestamp: Date.now()\r\n      };\r\n      \r\n      let readRate = 0;\r\n      if (this._prevDiskStats) {\r\n        const timeDiff = (currentStats.timestamp - this._prevDiskStats.timestamp) / 1000;\r\n        if (timeDiff > 0) {\r\n          // Simple disk read rate calculation\r\n          readRate = (currentStats.read.length - this._prevDiskStats.read.length) / timeDiff;\r\n        }\r\n      }\r\n      this._prevDiskStats = currentStats;\r\n      \r\n      return {\r\n        total: stats.blocks * stats.bsize,\r\n        free: stats.bfree * stats.bsize,\r\n        used: (stats.blocks - stats.bfree) * stats.bsize,\r\n        readRate\r\n      };\r\n    } catch (error) {\r\n      this.sdk.logger.warn('Could not collect detailed disk metrics:', error);\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async _getNetworkMetrics() {\r\n    const currentStats = os.networkInterfaces();\r\n    const currentTimestamp = Date.now();\r\n    \r\n    let bytesIn = 0;\r\n    let bytesOut = 0;\r\n    \r\n    if (this._prevNetworkStats) {\r\n      const timeDiff = (currentTimestamp - this._prevNetworkStats.timestamp) / 1000;\r\n      \r\n      Object.keys(currentStats).forEach(iface => {\r\n        const currentIf = currentStats[iface];\r\n        const prevIf = this._prevNetworkStats.stats[iface];\r\n        \r\n        if (prevIf) {\r\n          currentIf.forEach((curr, i) => {\r\n            if (prevIf[i] && curr.address === prevIf[i].address) {\r\n              bytesIn += (curr.bytesReceived - prevIf[i].bytesReceived) / timeDiff;\r\n              bytesOut += (curr.bytesSent - prevIf[i].bytesSent) / timeDiff;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    }\r\n    \r\n    this._prevNetworkStats = {\r\n      stats: currentStats,\r\n      timestamp: currentTimestamp\r\n    };\r\n    \r\n    return {\r\n      bytesIn,\r\n      bytesOut,\r\n      interfaces: Object.keys(currentStats)\r\n    };\r\n  }\r\n\r\n  _getProcessMetrics() {\r\n    return {\r\n      uptime: process.uptime(),\r\n      pid: process.pid,\r\n      ppid: process.ppid,\r\n      cpuUsage: process.cpuUsage(),\r\n      memoryUsage: process.memoryUsage()\r\n    };\r\n  }\r\n\r\n  _getLoadMetrics() {\r\n    return {\r\n      avg: os.loadavg(),\r\n      uptime: os.uptime()\r\n    };\r\n  }\r\n}","import { BrowserMonitor } from './browser';\r\nimport { NodeMonitor } from './node';\r\n\r\nclass Birdo {\r\n  constructor(options = {}) {\r\n    this.apiKey = options.apiKey;\r\n    this.serverName = options.serverName;\r\n    this.endpoint = options.endpoint || 'https://dashboard.birdo.uk';\r\n    this.interval = options.interval || 5000; // ms\r\n    this.maxRetries = options.maxRetries || 3;\r\n    this.timeout = options.timeout || 10000; // ms\r\n    this.logger = options.logger || console;\r\n    this._monitor = null;\r\n    this._intervalId = null;\r\n    \r\n    // Auto-detect environment\r\n    if (typeof window !== 'undefined') {\r\n      this._monitor = new BrowserMonitor(this);\r\n    } else {\r\n      this._monitor = new NodeMonitor(this);\r\n    }\r\n  }\r\n\r\n  async start() {\r\n    if (this._intervalId) {\r\n      this.logger.warn('Monitoring is already running');\r\n      return;\r\n    }\r\n    \r\n    // Initial collection\r\n    await this._collectAndSend();\r\n    \r\n    // Start periodic collection\r\n    this._intervalId = setInterval(\r\n      () => this._collectAndSend(),\r\n      this.interval\r\n    );\r\n    \r\n    this.logger.info(`Started monitoring with ${this.interval}ms interval`);\r\n  }\r\n\r\n  stop() {\r\n    if (!this._intervalId) {\r\n      this.logger.warn('Monitoring is not running');\r\n      return;\r\n    }\r\n    \r\n    clearInterval(this._intervalId);\r\n    this._intervalId = null;\r\n    this.logger.info('Monitoring stopped');\r\n  }\r\n\r\n  async sendOnce() {\r\n    return this._collectAndSend();\r\n  }\r\n\r\n  async _collectAndSend() {\r\n    try {\r\n      const metrics = await this._monitor.collectMetrics();\r\n      if (metrics) {\r\n        await this._sendMetrics(metrics);\r\n      }\r\n    } catch (error) {\r\n      this.logger.error('Error in monitoring cycle:', error);\r\n    }\r\n  }\r\n\r\n  async _sendMetrics(metrics) {\r\n    const payload = {\r\n      server_name: this.serverName,\r\n      metrics,\r\n      system_info: this._monitor.getSystemInfo()\r\n    };\r\n\r\n    const url = `${this.endpoint}/api/sdk/js`;\r\n    \r\n    for (let attempt = 1; attempt <= this.maxRetries; attempt++) {\r\n      try {\r\n        const response = await this._fetchWithTimeout(url, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'X-API-Key': this.apiKey\r\n          },\r\n          body: JSON.stringify(payload)\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n        }\r\n\r\n        this.logger.debug('Metrics sent successfully');\r\n        return true;\r\n      } catch (error) {\r\n        if (attempt === this.maxRetries) {\r\n          this.logger.error(`Failed to send metrics after ${this.maxRetries} attempts:`, error);\r\n          return false;\r\n        }\r\n        \r\n        const delay = Math.min(attempt * 2000, 30000); // Exponential backoff\r\n        await new Promise(resolve => setTimeout(resolve, delay));\r\n      }\r\n    }\r\n  }\r\n\r\n  async _fetchWithTimeout(url, options) {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), this.timeout);\r\n    \r\n    try {\r\n      const response = await fetch(url, {\r\n        ...options,\r\n        signal: controller.signal\r\n      });\r\n      clearTimeout(timeoutId);\r\n      return response;\r\n    } catch (error) {\r\n      clearTimeout(timeoutId);\r\n      throw error;\r\n    }\r\n  }\r\n}\r\n\r\nexport default Birdo;"],"names":["BrowserMonitor","constructor","sdk","_systemInfo","_getSystemInfo","platform","userAgent","navigator","screenResolution","window","screen","width","height","language","hardwareConcurrency","deviceMemory","getSystemInfo","collectMetrics","memory","performance","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","timestamp","Date","toISOString","timing","_getTimingMetrics","navigation","_getNavigationMetrics","connection","_getConnectionInfo","error","logger","dns","domainLookupEnd","domainLookupStart","tcp","connectEnd","connectStart","request","responseStart","requestStart","response","responseEnd","domLoading","navigationStart","domInteractive","domComplete","loadEvent","loadEventEnd","loadEventStart","getEntriesByType","type","redirectCount","size","transferSize","duration","mozConnection","webkitConnection","effectiveType","rtt","downlink","saveData","exec","util","promisify","require","NodeMonitor","_prevNetworkStats","_prevDiskStats","os","arch","release","hostname","cpuModel","cpus","model","cpuCores","length","totalMemory","totalmem","nodeVersion","process","version","v8Version","versions","v8","cpu","disk","network","Promise","all","_getCpuMetrics","_getMemoryMetrics","_getDiskMetrics","_getNetworkMetrics","_getProcessMetrics","load","_getLoadMetrics","loadavg","usage","cpuUsage","load1","load5","load15","speed","cores","system","total","free","freemem","used","memoryUsage","heap","getHeapStatistics","stats","fs","statfs","currentStats","read","stdout","now","readRate","timeDiff","blocks","bsize","bfree","warn","networkInterfaces","currentTimestamp","bytesIn","bytesOut","Object","keys","forEach","iface","currentIf","prevIf","curr","i","address","bytesReceived","bytesSent","interfaces","uptime","pid","ppid","avg","Birdo","options","apiKey","serverName","endpoint","interval","maxRetries","timeout","console","_monitor","_intervalId","start","_collectAndSend","setInterval","info","stop","clearInterval","sendOnce","metrics","_sendMetrics","payload","server_name","system_info","url","attempt","_fetchWithTimeout","method","headers","body","JSON","stringify","ok","Error","status","statusText","debug","delay","Math","min","resolve","setTimeout","controller","AbortController","timeoutId","abort","fetch","signal","clearTimeout"],"mappings":"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"}